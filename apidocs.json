{"openapi":"3.1.0","info":{"title":"Cantaso Legal Case Management API","description":"API para gestión de casos legales, intake y documentación multi-tenant","contact":{"name":"Analyzatech","url":"https://analyzatech.com","email":"support@analyzatech.com"},"license":{"name":"Apache 2.0","url":"https://www.apache.org/licenses/LICENSE-2.0.html"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8080/api/v2","description":"Generated server url"}],"security":[{"Bearer Authentication":[]}],"tags":[{"name":"Users","description":"User management endpoints with role-based access control"},{"name":"Intakes","description":"Intake (lead) management endpoints for case creation workflow"},{"name":"Authentication","description":"Authentication and token management endpoints"}],"paths":{"/intake/{id}":{"get":{"tags":["Intakes"],"summary":"Get intake by ID","description":"Retrieves a specific intake record by its UUID","operationId":"getIntake","parameters":[{"name":"id","in":"path","description":"Intake UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Intake found and returned","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"403":{"description":"User lacks INTAKE_READ permission","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"404":{"description":"Intake not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}}}},"put":{"tags":["Intakes"],"summary":"Update intake","description":"Updates an existing intake record. Only provided fields are modified","operationId":"updateIntake","parameters":[{"name":"id","in":"path","description":"Intake UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntakeUpdateRequest"}}},"required":true},"responses":{"200":{"description":"Intake updated successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"403":{"description":"User lacks INTAKE_UPDATE permission","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"400":{"description":"Invalid intake data provided","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"404":{"description":"Intake not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}}}},"delete":{"tags":["Intakes"],"summary":"Delete intake","description":"Deletes an intake record by its ID. This is a permanent deletion (not a soft delete)","operationId":"deleteIntake","parameters":[{"name":"id","in":"path","description":"Intake UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"403":{"description":"User lacks INTAKE_DELETE permission"},"204":{"description":"Intake deleted successfully"},"404":{"description":"Intake not found"}}}},"/iam/users/{id}":{"get":{"tags":["Users"],"summary":"Get user by ID","description":"Retrieves detailed information about a specific user. Requires appropriate read permissions and respects tenant isolation","operationId":"getUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"User found and returned","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"404":{"description":"User not found or not in current tenant","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"403":{"description":"Insufficient permissions or missing tenant context","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}}},"put":{"tags":["Users"],"summary":"Update user","description":"Updates user information. All fields are optional. Only provided fields are updated","operationId":"updateUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserRequest"}}},"required":true},"responses":{"200":{"description":"User updated successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{}}}},"403":{"description":"Insufficient permissions or wrong tenant","content":{"*/*":{"schema":{}}}}}},"delete":{"tags":["Users"],"summary":"Delete user","description":"Soft deletes a user (marks as deleted and inactive). If user has Cognito access, the Cognito account is also disabled. Data is not physically deleted","operationId":"deleteUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"403":{"description":"Insufficient permissions for user type","content":{"*/*":{"schema":{}}}},"204":{"description":"User deleted successfully","content":{"*/*":{"schema":{}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{}}}}}}},"/intake":{"get":{"tags":["Intakes"],"summary":"List all intakes","description":"Retrieves a paginated list of all intakes. Sorted by creation date in descending order by default","operationId":"getAllIntakes","parameters":[{"name":"pageable","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"Intakes retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/Page"}}}}}},"post":{"tags":["Intakes"],"summary":"Create new intake","description":"Creates a new intake (lead) record in the system. Intakes are the starting point for legal case creation","operationId":"createIntake","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntakeCreateRequest"}}},"required":true},"responses":{"403":{"description":"User lacks INTAKE_CREATE permission","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"201":{"description":"Intake created successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}},"400":{"description":"Invalid intake data provided","content":{"*/*":{"schema":{"$ref":"#/components/schemas/IntakeResponse"}}}}}}},"/iam/users":{"get":{"tags":["Users"],"summary":"List users","description":"Retrieves a list of users filtered by the current user's permission scope. Can optionally filter by user type and role. Results respect tenant isolation","operationId":"listUsers","parameters":[{"name":"userType","in":"query","description":"Filter by user type (CUSTOMER, PROFESSIONAL, STAFF, SCREENER, ADMIN, SYSTEM)","required":false,"schema":{"type":"string"}},{"name":"roleId","in":"query","description":"Filter by role ID","required":false,"schema":{"type":"string","format":"uuid"}}],"responses":{"403":{"description":"Insufficient permissions or missing tenant context","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserResponse"}}}}},"200":{"description":"Users retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}}},"post":{"tags":["Users"],"summary":"Create new user","description":"Creates a new user in the system. User types have different permission requirements. If sendInvitation is true, invitation email is sent immediately","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequest"}}},"required":true},"responses":{"400":{"description":"Invalid request or user already exists","content":{"*/*":{"schema":{}}}},"403":{"description":"Insufficient permissions for user type","content":{"*/*":{"schema":{}}}},"201":{"description":"User created successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}}}},"/iam/users/{id}/invite":{"post":{"tags":["Users"],"summary":"Invite user to portal","description":"Sends an invitation to a shadow user by creating their Cognito account. Invitation email with temporary password is sent. Only works for users without existing Cognito access","operationId":"inviteUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Invitation sent successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"400":{"description":"User already has portal access","content":{"*/*":{"schema":{}}}},"403":{"description":"Insufficient permissions","content":{"*/*":{"schema":{}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{}}}}}}},"/iam/users/{id}/enable":{"post":{"tags":["Users"],"summary":"Enable user","description":"Re-enables a previously disabled user. User is marked as active and Cognito account is enabled. User can log in again","operationId":"enableUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"403":{"description":"Insufficient permissions","content":{"*/*":{"schema":{}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{}}}},"200":{"description":"User enabled successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/iam/users/{id}/disable":{"post":{"tags":["Users"],"summary":"Disable user","description":"Disables user's portal access. User is marked as inactive and Cognito account is disabled. User can be re-enabled later","operationId":"disableUser","parameters":[{"name":"id","in":"path","description":"User UUID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"User disabled successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"403":{"description":"Insufficient permissions","content":{"*/*":{"schema":{}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{}}}}}}},"/auth/reset-password":{"post":{"tags":["Authentication"],"summary":"Reset password","operationId":"resetPassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/resend-code":{"post":{"tags":["Authentication"],"summary":"Resend confirmation code","operationId":"resendCode","parameters":[{"name":"email","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/register":{"post":{"tags":["Authentication"],"summary":"Register new user","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/refresh":{"post":{"tags":["Authentication"],"summary":"Refresh access token","operationId":"refreshToken","parameters":[{"name":"refresh_token","in":"cookie","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout user","operationId":"logout","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/login":{"post":{"tags":["Authentication"],"summary":"Login user","description":"Authenticates user and sets HttpOnly cookies","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"401":{"description":"Invalid credentials","content":{"*/*":{"schema":{}}}}}}},"/auth/forgot-password":{"post":{"tags":["Authentication"],"summary":"Initiate password reset","operationId":"forgotPassword","parameters":[{"name":"email","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/auth/confirm-email":{"post":{"tags":["Authentication"],"summary":"Confirm email address","operationId":"confirmEmail","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmEmailRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}}}}},"/intake/status/{status}":{"get":{"tags":["Intakes"],"summary":"Get intakes by status","description":"Retrieves intakes filtered by status (e.g., DRAFT, SUBMITTED, APPROVED). Results are paginated and sorted by creation date","operationId":"getIntakesByStatus","parameters":[{"name":"status","in":"path","description":"Intake status to filter by","required":true,"schema":{"type":"string"}},{"name":"pageable","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Pageable"}}],"responses":{"200":{"description":"Intakes retrieved successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/Page"}}}},"403":{"description":"User lacks INTAKE_READ permission","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PageIntakeResponse"}}}}}}},"/intake/generate-number":{"get":{"tags":["Intakes"],"summary":"Generate intake number","description":"Generates a new unique intake number for preview/display purposes. This does not create an intake, just generates the number","operationId":"generateIntakeNumber","responses":{"200":{"description":"Intake number generated successfully","content":{"*/*":{"schema":{"example":"INT-2025-00001"}}}}}}},"/auth/session":{"get":{"tags":["Authentication"],"summary":"Get current session","description":"Validates session cookie and returns user profile","operationId":"getSession","parameters":[{"name":"access_token","in":"cookie","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{}}}}}}}},"components":{"schemas":{"IntakeUpdateRequest":{"type":"object","properties":{"status":{"type":"string","enum":["PENDING","QUALIFIED","REJECTED","CONVERTED","FOLLOW_UP"]},"statusNote":{"type":"string","maxLength":1000,"minLength":0},"rejectedReason":{"type":"string","enum":["NO_INJURY","OUT_OF_STATE","STATUTE_EXPIRED","NO_LIABILITY","CLIENT_DECLINED","DUPLICATE","INSUFFICIENT_INFO","OTHER"]},"campaignId":{"type":"string","format":"uuid"},"referrerUrl":{"type":"string","maxLength":500,"minLength":0},"subsourceText":{"type":"string","maxLength":200,"minLength":0},"referralMethod":{"type":"string","enum":["TV","RADIO","SOCIAL_MEDIA","REFERRAL","BILLBOARD","INTERNET","WALK_IN","OTHER"]},"referralDetails":{"type":"string","maxLength":200,"minLength":0},"referredBy":{"type":"string","maxLength":200,"minLength":0},"accidentDate":{"type":"string","format":"date"},"accidentLocation":{"type":"string","maxLength":1000,"minLength":0},"description":{"type":"string","maxLength":5000,"minLength":0},"typeSpecificData":{"type":"object","additionalProperties":{}}}},"IntakeResponse":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"intakeNumber":{"type":"string"},"tenantId":{"type":"string","format":"uuid"},"intakeType":{"type":"string","enum":["PIMM","L2M","LEGAL","WORKERS_COMP","GENERAL"]},"status":{"type":"string","enum":["PENDING","QUALIFIED","REJECTED","CONVERTED","FOLLOW_UP"]},"statusNote":{"type":"string"},"rejectedReason":{"type":"string","enum":["NO_INJURY","OUT_OF_STATE","STATUTE_EXPIRED","NO_LIABILITY","CLIENT_DECLINED","DUPLICATE","INSUFFICIENT_INFO","OTHER"]},"brandId":{"type":"string","format":"uuid"},"brandName":{"type":"string"},"caseTypeId":{"type":"string","format":"uuid"},"clientUserId":{"type":"string","format":"uuid"},"campaignId":{"type":"string","format":"uuid"},"subsourceId":{"type":"string","format":"uuid"},"subsourceName":{"type":"string"},"referrerUrl":{"type":"string"},"subsourceText":{"type":"string"},"inboundPhoneNumber":{"type":"string"},"referralMethod":{"type":"string","enum":["TV","RADIO","SOCIAL_MEDIA","REFERRAL","BILLBOARD","INTERNET","WALK_IN","OTHER"]},"referralDetails":{"type":"string"},"referredBy":{"type":"string"},"accidentDate":{"type":"string","format":"date"},"accidentLocation":{"type":"string"},"description":{"type":"string"},"qualifiedAt":{"type":"string","format":"date-time"},"convertedAt":{"type":"string","format":"date-time"},"typeSpecificData":{"type":"object","additionalProperties":{}},"version":{"type":"integer","format":"int32"},"createdBy":{"type":"string","format":"uuid"},"updatedBy":{"type":"string","format":"uuid"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"UpdateUserRequest":{"type":"object","properties":{"firstName":{"type":"string","maxLength":100,"minLength":0},"lastName":{"type":"string","maxLength":100,"minLength":0},"phoneNumber":{"type":"string"},"roleId":{"type":"string","format":"uuid"},"brandId":{"type":"string","format":"uuid"},"timezone":{"type":"string"},"preferredLanguage":{"type":"string"},"isActive":{"type":"boolean"}}},"UserResponse":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"email":{"type":"string"},"firstName":{"type":"string"},"lastName":{"type":"string"},"fullName":{"type":"string"},"phoneNumber":{"type":"string"},"userType":{"type":"string"},"tenantId":{"type":"string","format":"uuid"},"brandId":{"type":"string","format":"uuid"},"roleId":{"type":"string","format":"uuid"},"roleName":{"type":"string"},"timezone":{"type":"string"},"preferredLanguage":{"type":"string"},"profilePictureUrl":{"type":"string"},"isActive":{"type":"boolean"},"canAuthenticate":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"IntakeCreateRequest":{"type":"object","properties":{"intakeType":{"type":"string","enum":["PIMM","L2M","LEGAL","WORKERS_COMP","GENERAL"]},"brandId":{"type":"string","format":"uuid"},"caseTypeId":{"type":"string","format":"uuid"},"campaignId":{"type":"string","format":"uuid"},"referrerUrl":{"type":"string","maxLength":500,"minLength":0},"subsourceId":{"type":"string","format":"uuid"},"subsourceText":{"type":"string","maxLength":200,"minLength":0},"inboundPhoneNumber":{"type":"string","maxLength":20,"minLength":0,"pattern":"^\\+?[1-9]\\d{1,14}$"},"referralMethod":{"type":"string","enum":["TV","RADIO","SOCIAL_MEDIA","REFERRAL","BILLBOARD","INTERNET","WALK_IN","OTHER"]},"referralDetails":{"type":"string","maxLength":200,"minLength":0},"referredBy":{"type":"string","maxLength":200,"minLength":0},"accidentDate":{"type":"string","format":"date"},"accidentLocation":{"type":"string","maxLength":1000,"minLength":0},"description":{"type":"string","maxLength":5000,"minLength":0},"typeSpecificData":{"type":"object","additionalProperties":{}}},"required":["brandId","description","intakeType"]},"CreateUserRequest":{"type":"object","properties":{"email":{"type":"string"},"firstName":{"type":"string","maxLength":100,"minLength":0},"lastName":{"type":"string","maxLength":100,"minLength":0},"phoneNumber":{"type":"string"},"userType":{"type":"string","enum":["STAFF","CUSTOMER","PROFESSIONAL","SCREENER","ADMIN","SYSTEM"]},"roleId":{"type":"string","format":"uuid"},"brandId":{"type":"string","format":"uuid"},"sendInvitation":{"type":"boolean"}},"required":["email","firstName","lastName","userType"]},"AuthResponse":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"redirectUrl":{"type":"string"}}},"ResetPasswordRequest":{"type":"object","properties":{"email":{"type":"string"},"confirmationCode":{"type":"string"},"newPassword":{"type":"string","maxLength":2147483647,"minLength":8}},"required":["confirmationCode","email","newPassword"]},"RegisterRequest":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string","maxLength":2147483647,"minLength":8},"firstName":{"type":"string","maxLength":100,"minLength":0},"lastName":{"type":"string","maxLength":100,"minLength":0},"phoneNumber":{"type":"string"}},"required":["email","firstName","lastName","password"]},"LoginRequest":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"}},"required":["email","password"]},"ConfirmEmailRequest":{"type":"object","properties":{"email":{"type":"string"},"confirmationCode":{"type":"string"}},"required":["confirmationCode","email"]},"Pageable":{"type":"object","properties":{"page":{"type":"integer","format":"int32","minimum":0},"size":{"type":"integer","format":"int32","minimum":1},"sort":{"type":"array","items":{"type":"string"}}}},"Page":{"type":"object","properties":{"totalPages":{"type":"integer","format":"int32"},"totalElements":{"type":"integer","format":"int64"},"pageable":{"$ref":"#/components/schemas/Pageablenull"},"first":{"type":"boolean"},"last":{"type":"boolean"},"size":{"type":"integer","format":"int32"},"content":{"type":"array","items":{}},"number":{"type":"integer","format":"int32"},"sort":{"$ref":"#/components/schemas/Sortnull"},"numberOfElements":{"type":"integer","format":"int32"},"empty":{"type":"boolean"}}},"Pageablenull":{"type":"object","properties":{"paged":{"type":"boolean"},"pageNumber":{"type":"integer","format":"int32"},"pageSize":{"type":"integer","format":"int32"},"unpaged":{"type":"boolean"},"offset":{"type":"integer","format":"int64"},"sort":{"$ref":"#/components/schemas/Sortnull"}}},"Sortnull":{"type":"object","properties":{"sorted":{"type":"boolean"},"unsorted":{"type":"boolean"},"empty":{"type":"boolean"}}},"PageIntakeResponse":{"type":"object","properties":{"totalPages":{"type":"integer","format":"int32"},"totalElements":{"type":"integer","format":"int64"},"pageable":{"$ref":"#/components/schemas/Pageablenull"},"first":{"type":"boolean"},"last":{"type":"boolean"},"size":{"type":"integer","format":"int32"},"content":{"type":"array","items":{"$ref":"#/components/schemas/IntakeResponse"}},"number":{"type":"integer","format":"int32"},"sort":{"$ref":"#/components/schemas/Sortnull"},"numberOfElements":{"type":"integer","format":"int32"},"empty":{"type":"boolean"}}}},"securitySchemes":{"Bearer Authentication":{"type":"http","description":"JWT token from Cognito","scheme":"bearer","bearerFormat":"JWT"}}}}